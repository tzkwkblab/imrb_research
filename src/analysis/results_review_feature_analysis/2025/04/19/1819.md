# 目的
レビュー分析において、レビューの評価点（星数）を入力から削除した場合の影響を検証する。

# 条件
- 特徴リストの要素は20個
- 各特徴が当てはまるかどうかの判定を0,1のみで出力
- 5回LLMを使用して結果の統計を取る
- モデル：gpt-4.1-mini
- temperature：0.7（前回実験と同じ）
- 変更点：レビューの評価点を入力から削除

## コスト分析
1回の分析あたり：
- 入力（約750トークン）: $0.40/1M = ¥0.045
- 出力（約200トークン）: $1.60/1M = ¥0.048
- 1回あたり合計: ¥0.093

5回試行での総コスト：¥0.465/レビュー
※ 評価点ありの場合（¥0.48/レビュー）と比較して約3%のコスト削減

## 実験データ

### レビューテキスト
前回と同じレビューテキストを使用

## プロンプト
```prompt
あなたは商品レビューを分析する専門家です。
以下の商品レビューに対して、各特徴が当てはまるかどうかを判定してください。

【レビュー】
{review_text}

【特徴リスト】
{features_list}

回答形式：
{
    "features": {
        "1": 0 or 1,
        "2": 0 or 1,
        ...
    }
}

※ 0=特徴なし、1=特徴あり
各特徴について、当てはまる場合は1、当てはまらない場合は0で回答してください。
```

## この実験での検証ポイント
1. 評価点の削除が判定精度に影響を与えるか
2. 安定性に変化が生じるか
3. コスト削減効果はどの程度か

## 結果

### レビュー1の分析
生データは[1819.csv](1819.csv)を参照してください。

#### 1. 判定精度の変化
- 前回との差異が見られた特徴：
  - 特徴3（競合製品との比較）: 安定性1.00→0.80
  - 特徴6（初期セットアップ）: 安定性0.80→0.60
  - 特徴7（製品の制限や欠点）: 新たに不安定化（安定性0.80）
  - 特徴20（ユーザーへのアドバイス）: 新たに不安定化（安定性0.60）

#### 2. 安定性分布の変化
- 安定性1.00: 16件（前回19件）
- 安定性0.80: 2件（前回1件）
- 安定性0.60: 2件（前回なし）
- 平均安定性: 0.94（前回0.99）

### コスト効率
- トークン数の削減：約50トークン/回
- コスト削減：約3%（¥0.48→¥0.465）

## 考察

### 1. 判定精度への影響
- 評価点の削除により、特に以下の判定が不安定化：
  - 製品の比較や評価に関する特徴（特徴3, 7）
  - ユーザー体験に関する特徴（特徴6, 20）
- これは評価点が文脈情報として機能していた可能性を示唆

### 2. 安定性への影響
- 平均安定性が0.99から0.94に低下
- 完全に安定した特徴が19件から16件に減少
- 新たに不安定化した特徴が出現

### 3. コスト効率
- 3%のコスト削減を実現
- ただし、安定性の低下を考慮すると、このコスト削減の意義は限定的

## 結論
評価点の削除は：
1. 判定の安定性を低下させる（特に評価や比較に関する特徴で顕著）
2. わずかなコスト削減（3%）は実現するものの、安定性低下のデメリットの方が大きい
3. 評価点は文脈理解に寄与している可能性が高く、入力として維持することを推奨

## 今後の方向性
1. 評価点は入力として維持
2. プロンプトの改善に注力
3. 試行回数の最適化を検討（安定性の高い特徴に対して）

### レビュー2の分析
生データは[1821.csv](1821.csv)を参照してください。

#### 1. 判定精度の変化
- 前回との差異が見られた特徴：
  - 特徴18（製品使用環境）: 安定性は0.80で変化なし
  - 特徴19（期待との一致/不一致）: 新たに不安定化（安定性0.60）

#### 2. 安定性分布の変化
- 安定性1.00: 18件（前回19件）
- 安定性0.80: 1件（前回1件）
- 安定性0.60: 1件（前回なし）
- 平均安定性: 0.97（前回0.99）

### コスト効率（両レビュー共通）
- トークン数の削減：約50トークン/回
- コスト削減：約3%（¥0.48→¥0.465）

## 考察

### 1. 判定精度への影響
- レビュー1では4つの特徴で不安定化
- レビュー2では2つの特徴で不安定化
- 特に以下の特徴で影響が顕著：
  - 製品の評価に関する特徴（特徴19）
  - 使用環境や体験に関する特徴（特徴18）
- 評価点は特に主観的な判断を要する特徴の判定に寄与している可能性

### 2. 安定性への影響
- レビュー1: 0.99 → 0.94（-0.05）
- レビュー2: 0.99 → 0.97（-0.02）
- 両レビューとも安定性が低下
- レビュー2の方が影響は小さい

### 3. コスト効率
- 両レビューとも3%のコスト削減を実現
- しかし、安定性低下のデメリットがコスト削減のメリットを上回る

## 結論
評価点の削除による影響：
1. 両レビューで安定性が低下（特にレビュー1で顕著）
2. 主観的な判断を要する特徴（評価、期待との一致など）で不安定化
3. コスト削減効果（3%）は限定的
4. 評価点は文脈理解の重要な要素として機能している

## 今後の方向性
1. 評価点は入力として維持することを強く推奨
   - 特に主観的な判断を要する特徴の安定性維持に重要
   - わずかなコスト削減よりも判定の質を優先

2. 改善の焦点を以下に移行：
   - プロンプトの最適化
   - 試行回数の調整（特徴ごとの安定性に基づく）
   - 特徴の定義の明確化 