# 統合対比因子生成実験レポート

## 実験概要

本実験では、リファクタリングされた新しい utils 統合ツールを活用して、
複数データセットにおける対比因子生成性能を包括的に評価しました。

| 項目             | 値                                                    |
| ---------------- | ----------------------------------------------------- |
| 実験日時         | 2025 年 7 月 25 日                                    |
| 実験設計         | 3 フェーズ構造（データ準備 → 実験実行 → 結果分析）    |
| 対象データセット | Steam, SemEval, Amazon                                |
| 総実験数         | 24 実験（3 データセット ×2-4 アスペクト ×3Shot 設定） |
| 評価指標         | BERT スコア（主要）・BLEU スコア（主要）              |

## 技術的新機能

### 新しい utils 統合ツール活用

1. **DatasetManager.from_config()**: 設定ファイル駆動による統一データセット管理
2. **ContrastFactorAnalyzer**: 統合分析による一貫した実験実行
3. **3 フェーズ実験パターン**: 段階的実験管理による品質保証
4. **自動レポート生成**: JSON・Markdown 形式での結果出力

### アーキテクチャ改善

- **責任分離**: 設定・ローダー・分割戦略の明確な分離
- **拡張性**: 新データセット・新分割戦略の簡単追加
- **テスト容易性**: モジュール単位での検証可能
- **設定駆動**: YAML 設定による実験パラメータ管理

## 実験設計

### Phase 1: データ準備

- 設定検証（YAML 設定ファイルの妥当性確認）
- データセット利用可能性確認
- 統計情報取得（各データセットのサンプル数・品質）
- 実験マトリックス生成（24 実験の組み合わせ定義）

### Phase 2: 対比実験実行

- データ分割取得（アスペクト別・ドメイン別分割）
- Few-shot 例題作成（0/1/3shot 設定対応）
- 対比因子分析実行（GPT API 呼び出し・スコア計算）
- 中間結果保存（実験途中での進捗保存）

### Phase 3: 結果分析・保存

- 包括的結果構造化（全実験結果の統合）
- 統計サマリー生成（平均値・分布・データセット別分析）
- JSON・Markdown 出力（機械可読・人間可読両対応）

## データセット構成

| データセット | ドメイン          | アスペクト      | 分割戦略         | 実験数 |
| ------------ | ----------------- | --------------- | ---------------- | ------ |
| Steam        | Gaming            | gameplay, story | binary_label     | 6      |
| SemEval      | Restaurant/Laptop | food, service   | aspect_vs_others | 12     |
| Amazon       | E-commerce        | quality, price  | aspect_vs_others | 6      |

## 期待される成果

### 実験品質向上

- **再現性**: ランダムシード固定・設定ファイル駆動
- **ロバスト性**: エラーハンドリング・失敗ケース記録
- **トレーサビリティ**: 全実験パラメータ・中間結果の保存

### 技術的貢献

- **設定ファイル駆動**: 実験設定の外部化・管理容易性
- **責任分離**: モジュール化によるメンテナンス性向上
- **拡張性**: 新データセット・新手法の容易な追加
- **自動化**: レポート生成・結果分析の自動化

### 評価指標重視

- **BERT スコア**: 意味類似度評価（深層学習ベース）
- **BLEU スコア**: 表層一致度評価（統計ベース）
- 分類精度は参考値として記録（主要評価軸ではない）

## 実行方法

```bash
# 実験ディレクトリに移動
cd src/analysis/experiments/2025/07/25/

# 実験設定確認
python3 experiment_config.py

# 完全実験実行
python3 unified_contrast_experiment.py
```

## 想定される課題と対策

### データアクセス

- **課題**: 一部データセットの利用不可
- **対策**: Phase 1 での事前確認・アクセス可能データセットのみ実行

### API 制限

- **課題**: GPT API 呼び出し制限・ネットワークエラー
- **対策**: リトライ機能・エラーハンドリング・進捗保存

### スケーラビリティ

- **課題**: 大規模実験での実行時間
- **対策**: 並列処理・バッチ実行・中間結果保存

## 実装品質基準

- **コード品質**: シンプル・最小限・SOLID 原則準拠
- **命名規則**: わかりやすく簡潔
- **エラー処理**: 適切な例外ハンドリング
- **ログ出力**: 詳細な実行状況追跡
- **ドキュメント**: 最小限・冗長表現回避

---

_このレポートは実験実行時に自動更新されます_
